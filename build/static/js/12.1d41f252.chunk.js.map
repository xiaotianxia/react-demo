{"version":3,"sources":["request/api.js","utils/util.js","pages/login/Login.js"],"names":["HOST","request","path","param","Promise","resolve","reject","fullUrl","parseTpl","serializeJson","client_id","client_secret","fetch","then","r","text","res","JSON","parse","catch","err","getUser","getRepos","getFollowing","getFollowers","getInfo","getRepoDetail","getEvents","template","context","replace","match","key","trim","json","Object","entries","map","item","join","cutStr","val","length","substr","RegistrationForm","state","loading","handleSubmit","e","preventDefault","props","form","validateFields","values","setState","username","api","data","this","id","ls","set","history","push","getFieldDecorator","get","to","className","onSubmit","Item","rules","required","message","prefix","type","style","color","placeholder","textAlign","htmlType","React","Component","WrappedRegistrationForm","Form","create","name","withRouter"],"mappings":"uIAEMA,EAAO,yBAEb,SAASC,EAAQC,EAAMC,GACnB,OAAO,IAAIC,SAAQ,SAACC,EAASC,GACzB,IAAIC,EAAUC,YAASR,EAAOE,EAAMC,GACpCI,EAAUA,EAAU,IAAME,YAAc,eACjCN,EADgC,CAEnCO,UAAW,uBACXC,cAAe,8CAEnBC,MAAML,GAASM,MAAK,SAAAC,GAAC,OAAIA,EAAEC,OAAOF,MAAK,SAAAG,GACnCX,EAAQY,KAAKC,MAAMF,UACnBG,OAAM,SAAAC,GACNd,EAAOc,SAKJ,KACXC,QADW,SACHlB,GACJ,OAAOF,EAAQ,sBAAuBE,IAG1CmB,SALW,SAKFnB,GACL,OAAOF,EAAQ,4BAA6BE,IAGhDoB,aATW,SASEpB,GACT,OAAOF,EAAQ,gCAAiCE,IAGpDqB,aAbW,SAaErB,GACT,OAAOF,EAAQ,gCAAiCE,IAGpDsB,QAjBW,SAiBHtB,GACJ,OAAOF,EAAQ,sBAAuBE,IAG1CuB,cArBW,SAqBGvB,GACV,OAAOF,EAAQ,+BAAgCE,IAGnDwB,UAzBW,SAyBDxB,GACN,OAAOF,EAAQ,6BAA8BE,M,iCC9CrD,sGAAO,IAAMK,EAAW,SAACoB,EAAUC,GAC/B,OAAOD,EAASE,QAAQ,kBAAkB,SAACC,EAAOC,GAAR,OAAgBH,EAAQG,EAAIC,YAG7DxB,EAAgB,SAACyB,GAC1B,OAAOC,OAAOC,QAAQF,GAAMG,KAAI,SAAAC,GAC5B,MAAM,GAAN,OAAUA,EAAK,GAAf,YAAqBA,EAAK,OAC3BC,KAAK,MAGCC,EAAS,SAACC,GAAsB,IAAjBC,EAAgB,uDAAP,GACjC,OAAID,GAAOA,EAAIC,OAASA,EACd,GAAN,OAAUD,EAAIE,OAAO,EAAGD,GAAxB,OAEGD,I,iNCFLG,E,2MACFC,MAAQ,CACJC,SAAS,G,EAGbC,aAAe,SAAAC,GACXA,EAAEC,iBACF,EAAKC,MAAMC,KAAKC,gBAAe,SAAChC,EAAKiC,GAC5BjC,IACD,EAAKkC,SAAS,CAAER,SAAS,IACzB,EAAKzB,QAAQgC,EAAOE,e,uEAKlBA,G,kGACSC,IAAInC,QAAQ,CAAEkC,c,OAA3BE,E,OACNC,KAAKJ,SAAS,CAAER,SAAS,IACrBW,EAAKE,KACLC,IAAGC,IAAI,yBAA0BN,GACjCG,KAAKR,MAAMY,QAAQC,KAAK,U,gFAItB,IACEC,EAAsBN,KAAKR,MAAMC,KAAjCa,kBAER,OADaJ,IAAGK,IAAI,0BAER,kBAAC,IAAD,CAAUC,GAAG,UAEd,yBAAKC,UAAU,SAClB,kBAAC,IAAD,CAAMC,SAAUV,KAAKX,aAAcoB,UAAU,cACzC,kBAAC,IAAKE,KAAN,KACKL,EAAkB,WAAY,CAC3BM,MAAO,CAAC,CAAEC,UAAU,EAAMC,QAAS,iCADtCR,CAGG,kBAAC,IAAD,CACIS,OAAQ,kBAAC,IAAD,CAAMC,KAAK,OAAOC,MAAO,CAAEC,MAAO,qBAC1CC,YAAY,eAIxB,kBAAC,IAAKR,KAAN,CAAWM,MAAO,CAAEG,UAAW,WAC3B,kBAAC,IAAD,CAAQJ,KAAK,UAAU5B,QAASY,KAAKb,MAAMC,QAASiC,SAAS,UAA7D,iB,GA3COC,IAAMC,WAmD/BC,EAA0BC,IAAKC,OAAO,CAAEC,KAAM,YAApBF,CAAkCvC,GAEnD0C,sBAAWJ","file":"static/js/12.1d41f252.chunk.js","sourcesContent":["import { parseTpl, serializeJson } from '@/utils/util';\n\nconst HOST = 'https://api.github.com';\n\nfunction request(path, param) {\n    return new Promise((resolve, reject) => {\n        let fullUrl = parseTpl(HOST + path, param);\n        fullUrl = fullUrl + '?' + serializeJson({\n            ...param,\n            client_id: 'aa18248a5e12eca15a6f',\n            client_secret: '389eac9e777a6ced5127b45193640580174c426d'\n        })\n        fetch(fullUrl).then(r => r.text().then(res => {\n            resolve(JSON.parse(res));\n        })).catch(err => {\n            reject(err);\n        });\n    });\n}\n\nexport default {\n    getUser(param) {\n        return request('/users/{{username}}', param);\n    },\n\n    getRepos(param) {\n        return request('/users/{{username}}/repos', param);\n    },\n\n    getFollowing(param) {\n        return request('/users/{{username}}/following', param);\n    },\n\n    getFollowers(param) {\n        return request('/users/{{username}}/followers', param);\n    },\n\n    getInfo(param) {\n        return request('/users/{{username}}', param);\n    },\n\n    getRepoDetail(param) {\n        return request('/repos/{{username}}/{{repo}}', param);\n    },\n\n    getEvents(param) {\n        return request('/users/{{username}}/events', param);\n    }\n};","export const parseTpl = (template, context) => {\n    return template.replace(/\\{\\{(.*?)\\}\\}/g, (match, key) => context[key.trim()]);\n}\n\nexport const serializeJson = (json) => {\n    return Object.entries(json).map(item => {\n        return `${item[0]}=${item[1]}`\n    }).join('&')\n}\n\nexport const cutStr = (val, length = 30) => {\n    if (val && val.length > length) {\n        return `${val.substr(0, length)}...`;\n    }\n    return val;\n}","import React from 'react';\nimport { \n    Form,\n    Icon,\n    Input,\n    Button,\n} from 'antd';\nimport './login.scss';\nimport api from '@api';\nimport { withRouter, Redirect } from 'react-router-dom';\nimport { ls } from '@utils/localStorage';\n\nclass RegistrationForm extends React.Component {\n    state = {\n        loading: false\n    }\n\n    handleSubmit = e => {\n        e.preventDefault();\n        this.props.form.validateFields((err, values) => {\n            if (!err) {\n                this.setState({ loading: true} );\n                this.getUser(values.username);\n            }\n        });\n    };\n\n    async getUser(username) {\n        const data = await api.getUser({ username });\n        this.setState({ loading: false });\n        if (data.id) {\n            ls.set('my_github_app_username', username);\n            this.props.history.push('repos');\n        }\n    }\n\n    render() {\n        const { getFieldDecorator } = this.props.form;\n        const user = ls.get('my_github_app_username');\n        if (user) {\n            return (<Redirect to=\"repos\" />);\n        } else {\n            return <div className=\"login\">\n                <Form onSubmit={this.handleSubmit} className=\"login-form\">\n                    <Form.Item>\n                        {getFieldDecorator('username', {\n                            rules: [{ required: true, message: 'Please input your username!' }],\n                        })(\n                            <Input\n                                prefix={<Icon type=\"user\" style={{ color: 'rgba(0,0,0,.25)' }} />}\n                                placeholder=\"Username\"\n                            />,\n                        )}\n                    </Form.Item>\n                    <Form.Item style={{ textAlign: 'center' }}>\n                        <Button type=\"primary\" loading={this.state.loading} htmlType=\"submit\">Log in</Button>\n                    </Form.Item>\n                </Form>\n            </div>\n        }\n    }\n}\n\nconst WrappedRegistrationForm = Form.create({ name: 'register' })(RegistrationForm);\n\nexport default withRouter(WrappedRegistrationForm);"],"sourceRoot":""}